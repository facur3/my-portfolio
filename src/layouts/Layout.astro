---
import { ViewTransitions } from "astro:transitions";
import SpeedInsights from "@vercel/speed-insights/astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import Navbar from "../components/Navbar.astro";
const { title } = Astro.props;
---

<!doctype html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, viewport-fit=cover"
        />
        <title>{title}</title>

        <!-- SEO Meta Tags -->
        <meta
            name="description"
            content="Portfolio de Facu Rossi â€“ Desarrollador y programador especializado en soluciones modernas, AI, Web Development, y Full-stack Systems."
        />
        <meta
            name="keywords"
            content="Facu Rossi, Portfolio, Desarrollador, Programador, AI, Web, Full-stack"
        />

        <!-- Google Fonts: Inter -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"
            rel="stylesheet"
        />

        <!-- Speed Insights -->
        <SpeedInsights />

        <!-- Open Graph / Facebook -->
        <meta property="og:title" content="Facu Rossi - Portfolio" />
        <meta
            property="og:description"
            content="Descubre los proyectos y habilidades de Facu Rossi. Especializado en soluciones modernas, inteligencia artificial y desarrollo full-stack."
        />
        <meta property="og:image" content="/social-share.png" />
        <meta
            property="og:url"
            content="https://my-portfolio-seven-gules-67.vercel.app/"
        />
        <meta property="og:type" content="website" />

        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="Facu Rossi - Portfolio" />
        <meta
            name="twitter:description"
            content="Descubre los proyectos y habilidades de Facu Rossi. Especializado en soluciones modernas, inteligencia artificial y desarrollo full-stack."
        />
        <meta name="twitter:image" content="/social-share.png" />

        <!-- Favicon and Web Manifest -->
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />

        <!-- View Transitions -->
        <ViewTransitions />

        <!-- Dark Theme Initialization Script -->
        <script is:inline>
            (function () {
                const savedTheme = localStorage.getItem("theme") || "system";
                const systemDark = window.matchMedia(
                    "(prefers-color-scheme: dark)",
                ).matches;
                if (
                    savedTheme === "dark" ||
                    (savedTheme === "system" && systemDark)
                ) {
                    document.documentElement.classList.add("dark");
                }
            })();
        </script>

        <script is:inline type="application/ld+json">
            {
                "@context": "https://schema.org",
                "@type": "Person",
                "name": "Facundo Rossi",
                "jobTitle": "Analista de Sistemas",
                "url": "https://my-portfolio-seven-gules-67.vercel.app/",
                "sameAs": [
                    "https://www.linkedin.com/in/facu-rossi-a5839a278/",
                    "https://github.com/facur3"
                ],
                "alumniOf": {
                    "@type": "EducationalOrganization",
                    "name": "Universidad de Buenos Aires"
                },
                "hasOccupation": {
                    "@type": "Occupation",
                    "name": "Software Developer",
                    "skills": [
                        "JavaScript",
                        "Python",
                        "React",
                        "AI",
                        "Astro",
                        "Tailwind CSS"
                    ]
                }
            }
        </script>
    </head>
    <body
        id="top"
        class="bg-zinc-100 dark:bg-[#050505] text-zinc-900 dark:text-white antialiased selection:bg-zinc-300 dark:selection:bg-white/20 w-full overflow-x-hidden pt-[env(safe-area-inset-top)] transition-colors duration-300"
    >
        <!-- Clean Minimalist Background -->
        <div
            class="fixed inset-0 -z-50 bg-gradient-to-br from-zinc-50 to-zinc-200 dark:bg-[#050505] dark:bg-[radial-gradient(ellipse_80%_80%_at_50%_-20%,rgba(120,119,198,0.1),rgba(255,255,255,0))] transition-colors duration-300"
        >
        </div>

        <Navbar />

        <main class="w-full max-w-[1100px] mx-auto px-4 sm:px-6 lg:px-8">
            <slot />
        </main>

        <Footer />

        <!-- Scroll to Top Button (Mobile Only) -->
        <button
            id="scroll-to-top"
            aria-label="Volver arriba"
            class="fixed bottom-6 right-6 z-50 p-3 rounded-full bg-white dark:bg-zinc-900/90 text-zinc-900 dark:text-white shadow-lg backdrop-blur-sm border border-zinc-300 dark:border-zinc-700/50 opacity-0 translate-y-10 pointer-events-none transition-all duration-300 md:hidden"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                class="size-6"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                fill="none"
                stroke-linecap="round"
                stroke-linejoin="round"
            >
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path d="M12 5l0 14"></path>
                <path d="M18 11l-6 -6"></path>
                <path d="M6 11l6 -6"></path>
            </svg>
        </button>
    </body>
</html>

<style is:global>
    html {
        font-family: "Inter", system-ui, sans-serif;
        scroll-behavior: smooth;
        scroll-padding-top: 100px;
    }

    html.dark {
        color-scheme: dark;
    }

    @keyframes fade-in-up {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .animate-fade-in-up {
        animation: fade-in-up 0.8s ease-out forwards;
    }

    /* Scroll Reveal Animation */
    .reveal {
        opacity: 0;
        transform: translateY(30px);
        transition: all 0.8s ease-out;
    }

    .reveal.active {
        opacity: 1;
        transform: translateY(0);
    }

    /* Hide Scroll to Top when Mobile Menu is Open */
    body.menu-open #scroll-to-top {
        opacity: 0 !important;
        pointer-events: none !important;
        transform: translateY(
            10px
        ); /* Optional: move it down slightly for effect */
    }
</style>

<script>
    const observerOptions = {
        root: null,
        rootMargin: "0px",
        threshold: 0.1,
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            if (entry.isIntersecting) {
                entry.target.classList.add("active");
                observer.unobserve(entry.target); // Only animate once
            }
        });
    }, observerOptions);

    document.addEventListener("astro:page-load", () => {
        document
            .querySelectorAll(".reveal")
            .forEach((el) => observer.observe(el));
    });

    // Fallback for initial load if not using ViewTransitions or similar
    document.addEventListener("DOMContentLoaded", () => {
        document
            .querySelectorAll(".reveal")
            .forEach((el) => observer.observe(el));
    });

    // Scroll to Top Logic
    const scrollBtn = document.getElementById("scroll-to-top");

    if (scrollBtn) {
        window.addEventListener("scroll", () => {
            if (window.scrollY > 1300) {
                scrollBtn.classList.remove(
                    "opacity-0",
                    "translate-y-10",
                    "pointer-events-none",
                );
            } else {
                scrollBtn.classList.add(
                    "opacity-0",
                    "translate-y-10",
                    "pointer-events-none",
                );
            }
        });

        scrollBtn.addEventListener("click", () => {
            window.scrollTo({
                top: 0,
                behavior: "smooth",
            });
        });
    }
</script>
